<!DOCTYPE html>
<html>
<head>
    <script src="lib/jquery/dist/jquery.min.js"></script>
    <script src="lib/bootstrap/dist/js/bootstrap.js"></script>
    <script src="lib/bootstrap-table/dist/bootstrap-table.js"></script>
    <link rel="stylesheet" href="lib/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="lib/bootstrap-table/dist/bootstrap-table.css">

</head>
<body onload="onloadListEvents()">

<div class="container">
    <h2>Got Something to Share?</h2>
    <a href="event-form.html" id="addBtn" class="btn btn-primary">Add Event</a>
    <br>
</div>
<div class="container">
    <h2>Upcoming Events from Us!</h2>
    <p></p>
    <table class="table table-hover" id="table">
        <thead class="thead-inverse">
        <tr>
            <th data-field="count">#</th>
            <th width="20%" data-field="category">Category</th>
            <th width="40%" data-field="eventName">Event Name</th>
            <th width="10%" data-field="startDateStr">Start Date</th>
            <th width="10%" data-field="endDateStr">End Date</th>
            <th width="20%" data-field="button"></th>
        </tr>
        </thead>
    </table>
    <br>
</div>
<br>

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <h3 style="text-align:center;">Cannot Retrieve Data From Database.</h3>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
    </div>
</div>

<style>
    td {
        vertical-align: middle !important;
    }
</style>

<script>
    var formatTable = function () {
        /*$('table tr').each(function(index) {
            $(this).find('td:nth-child(1)').html(index);
        });*/
        //$("th").css("text-align", "center");
        $("th").css("color", "#ffffff");
        $("th").css("background-color", "#3275ad");
        $("td").css("vertical-align", "middle");
    };

    function onloadListEvents(){
        var error = getParameter("error");
        if(error === "true"){
            $('#myModal').modal('show');
        }

        $.ajax({
            type : "GET",
            contentType : "application/json",
            url : "/content",
            //data : JSON.stringify(data),
            dataType : 'json',
            timeout : 100000,
            success : function(data) {
                console.log("SUCCESS: ", data);
                var $table = $('#table');
                $table.bootstrapTable({
                    data: data,
                    pagination: true
                });

                formatTable();
            },
            error : function(e) {
                console.log("ERROR: ", e);
            },
            done : function(e) {
                console.log("DONE");
            }
        });

    }

    function getParameter(sParam) {
    var sPageURL = decodeURIComponent(window.location.search.substring(1)),
        sURLVariables = sPageURL.split('&'),
        sParameterName,
        i;

    for (i = 0; i < sURLVariables.length; i++) {
        sParameterName = sURLVariables[i].split('=');

        if (sParameterName[0] === sParam) {
            return sParameterName[1] === undefined ? "" : sParameterName[1];
        }
    }
    return "";
}
</script>
</body>

</html>
